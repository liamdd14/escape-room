<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Forces Escape Room</title>
  <script src="/_sdk/element_sdk.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
        body {
            box-sizing: border-box;
        }
        
        .room-container {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            min-height: 100%;
            position: relative;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        .puzzle-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }
        
        .puzzle-card:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 255, 0.2);
        }
        
        .solved {
            background: rgba(34, 197, 94, 0.2);
            border-color: rgba(34, 197, 94, 0.5);
        }
        
        .locked {
            opacity: 0.5;
            pointer-events: none;
        }
        
        .answer-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            transition: all 0.2s ease;
        }
        
        .answer-btn:hover {
            background: rgba(0, 255, 255, 0.2);
            border-color: rgba(0, 255, 255, 0.5);
            transform: translateY(-1px);
        }
        
        .correct-answer {
            background: rgba(34, 197, 94, 0.3);
            border-color: rgba(34, 197, 94, 0.7);
            animation: pulse-green 1s ease-in-out;
        }
        
        .wrong-answer {
            background: rgba(239, 68, 68, 0.3);
            border-color: rgba(239, 68, 68, 0.7);
            animation: shake 0.5s ease-in-out;
        }
        
        @keyframes pulse-green {
            0%, 100% { box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.7); }
            50% { box-shadow: 0 0 0 10px rgba(34, 197, 94, 0); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .progress-orb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
        }
        
        .progress-orb.completed {
            background: rgba(0, 255, 255, 0.8);
            border-color: rgba(0, 255, 255, 1);
            box-shadow: 0 0 15px rgba(0, 255, 255, 0.5);
        }
        
        .escape-timer {
            font-family: 'Courier New', monospace;
            color: #00ffff;
            text-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
        }
        
        .glitch {
            animation: glitch 2s infinite;
        }
        
        @keyframes glitch {
            0%, 100% { transform: translateX(0); }
            20% { transform: translateX(-2px); }
            40% { transform: translateX(2px); }
            60% { transform: translateX(-1px); }
            80% { transform: translateX(1px); }
        }
        
        .victory-animation {
            animation: victory-pulse 2s ease-in-out infinite;
        }
        
        @keyframes victory-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
 </head>
 <body class="room-container text-white"><!-- Background Effects -->
  <div class="absolute inset-0 opacity-20">
   <div class="absolute top-10 left-10 w-2 h-2 bg-cyan-400 rounded-full animate-ping"></div>
   <div class="absolute top-20 right-20 w-1 h-1 bg-green-400 rounded-full animate-pulse"></div>
   <div class="absolute bottom-20 left-20 w-1 h-1 bg-blue-400 rounded-full animate-bounce"></div>
   <div class="absolute bottom-10 right-10 w-2 h-2 bg-purple-400 rounded-full animate-ping"></div>
  </div>
  <main class="container mx-auto px-4 py-4 max-w-4xl relative z-10 min-h-full"><!-- Header -->
   <header class="text-center mb-6">
    <h1 id="room-title" class="text-3xl md:text-4xl font-bold mb-3 glitch" style="color: #00ffff; text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);">üîí FORCES ESCAPE ROOM üîí</h1>
    <div class="escape-timer text-lg md:text-xl mb-3">
     ‚è∞ TIMER: <span id="timer">‚àû</span>
    </div>
    <p id="story-intro" class="text-sm md:text-base text-cyan-100 max-w-2xl mx-auto leading-relaxed">üö® ALERT: You're trapped in Newton's laboratory! The only way to escape is by solving 16 physics puzzles about forces. Each correct answer unlocks the next puzzle. Can you master the relationship between gravity and other forces to break free? üö®</p>
   </header><!-- Progress Tracker -->
   <div class="mb-6 p-4 puzzle-card rounded-xl">
    <div class="flex flex-col sm:flex-row justify-between items-center mb-3 gap-2">
     <h3 class="text-lg font-bold text-cyan-300">üîì ESCAPE PROGRESS</h3><span id="progress-text" class="text-cyan-300 font-mono text-sm">0 / 16 PUZZLES SOLVED</span>
    </div>
    <div class="flex gap-1 flex-wrap justify-center">
     <div id="progress-orbs" class="flex gap-1 flex-wrap justify-center"><!-- Progress orbs will be generated here -->
     </div>
    </div>
   </div><!-- Current Puzzle Display -->
   <div id="current-puzzle" class="mb-8 pb-8"><!-- Current puzzle will be displayed here -->
   </div><!-- Escape Success -->
   <div id="escape-success" class="hidden text-center p-8 puzzle-card rounded-xl victory-animation">
    <div class="text-8xl mb-4">
     üéâ
    </div>
    <h2 class="text-4xl font-bold text-green-400 mb-4">ESCAPE SUCCESSFUL!</h2>
    <p class="text-xl text-green-300 mb-6">Congratulations! You've mastered the forces and escaped Newton's laboratory!</p>
    <div class="text-6xl mb-4">
     üîì
    </div><button id="restart-btn" class="bg-gradient-to-r from-cyan-500 to-blue-600 text-white px-8 py-4 rounded-lg font-bold text-xl hover:from-cyan-600 hover:to-blue-700 transition-all duration-200 transform hover:scale-105"> üîÑ ENTER NEW ESCAPE ROOM </button>
   </div>
  </main>
  <script>
        const defaultConfig = {
            room_title: "üîí FORCES ESCAPE ROOM üîí",
            story_intro: "üö® ALERT: You're trapped in Newton's laboratory! The only way to escape is by solving 16 physics puzzles about forces. Each correct answer unlocks the next puzzle. Can you master the relationship between gravity and other forces to break free? üö®",
            success_message: "üîì PUZZLE SOLVED! The force is strong with you!",
            failure_message: "‚ùå INCORRECT! The security system remains locked. Think about the forces..."
        };

        let currentPuzzleIndex = 0;
        let solvedPuzzles = new Set();
        let startTime = Date.now();
        let timerInterval;

        const puzzles = [
            {
                id: 1,
                title: "üìö THE LIBRARY CLUE",
                scenario: "A book rests on Newton's desk",
                correctAnswer: "equal",
                explanation: "The book is in equilibrium - the desk pushes up with exactly the same force as gravity pulls down!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <rect x="10" y="50" width="80" height="15" fill="#8B4513" stroke="#654321" stroke-width="2"/>
                    <rect x="35" y="35" width="30" height="15" fill="#4169E1" stroke="#000080" stroke-width="2"/>
                    <text x="50" y="45" text-anchor="middle" font-size="8" fill="white">BOOK</text>
                    <line x1="10" y1="65" x2="90" y2="65" stroke="#654321" stroke-width="4"/>
                </svg>`
            },
            {
                id: 2,
                title: "üè¢ ELEVATOR ESCAPE",
                scenario: "You're in an elevator accelerating upward toward freedom",
                correctAnswer: "greater",
                explanation: "To accelerate upward, the elevator floor must push up harder than gravity pulls down!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <rect x="25" y="15" width="50" height="55" fill="#C0C0C0" stroke="#808080" stroke-width="3"/>
                    <circle cx="50" cy="35" r="6" fill="#FFB6C1"/>
                    <rect x="47" y="41" width="6" height="15" fill="#4169E1"/>
                    <line x1="44" y1="56" x2="47" y2="62" stroke="#000" stroke-width="2"/>
                    <line x1="56" y1="56" x2="53" y2="62" stroke="#000" stroke-width="2"/>
                    <polygon points="80,25 85,15 90,25" fill="#FF0000"/>
                    <text x="78" y="12" font-size="6" fill="#FF0000">UP</text>
                </svg>`
            },
            {
                id: 3,
                title: "‚öñÔ∏è THE WEIGHT CHAMBER",
                scenario: "A person stands on a scale at rest",
                correctAnswer: "equal",
                explanation: "At rest, the scale reading equals the gravitational force - perfect balance!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <circle cx="50" cy="20" r="6" fill="#FFB6C1"/>
                    <rect x="47" y="26" width="6" height="15" fill="#4169E1"/>
                    <line x1="44" y1="41" x2="47" y2="47" stroke="#000" stroke-width="2"/>
                    <line x1="56" y1="41" x2="53" y2="47" stroke="#000" stroke-width="2"/>
                    <rect x="35" y="47" width="30" height="6" fill="#808080" stroke="#000" stroke-width="2"/>
                    <circle cx="50" cy="58" r="10" fill="#E0E0E0" stroke="#000" stroke-width="2"/>
                    <text x="50" y="61" text-anchor="middle" font-size="7" fill="#000">150 N</text>
                </svg>`
            },
            {
                id: 4,
                title: "üèÄ JUMP TO FREEDOM",
                scenario: "A basketball player leaps upward from the laboratory floor",
                correctAnswer: "greater",
                explanation: "During takeoff, the ground pushes up with more force than gravity to launch the player upward!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <circle cx="50" cy="25" r="6" fill="#FFB6C1"/>
                    <rect x="47" y="31" width="6" height="12" fill="#FF4500"/>
                    <line x1="41" y1="36" x2="35" y2="28" stroke="#FFB6C1" stroke-width="2"/>
                    <line x1="59" y1="36" x2="65" y2="28" stroke="#FFB6C1" stroke-width="2"/>
                    <line x1="44" y1="43" x2="41" y2="52" stroke="#000" stroke-width="2"/>
                    <line x1="56" y1="43" x2="59" y2="52" stroke="#000" stroke-width="2"/>
                    <circle cx="75" cy="35" r="4" fill="#FF8C00"/>
                    <line x1="10" y1="55" x2="90" y2="55" stroke="#8B4513" stroke-width="4"/>
                    <polygon points="80,20 85,10 90,20" fill="#FF0000"/>
                    <text x="78" y="7" font-size="6" fill="#FF0000">UP</text>
                </svg>`
            },
            {
                id: 5,
                title: "üèÉ CONSTANT SPEED CORRIDOR",
                scenario: "You're running at constant speed through the lab corridor",
                correctAnswer: "equal",
                explanation: "At constant velocity, no acceleration means forces are perfectly balanced!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <circle cx="50" cy="25" r="6" fill="#FFB6C1"/>
                    <rect x="47" y="31" width="6" height="12" fill="#4169E1"/>
                    <line x1="41" y1="36" x2="35" y2="30" stroke="#FFB6C1" stroke-width="2"/>
                    <line x1="59" y1="36" x2="65" y2="30" stroke="#FFB6C1" stroke-width="2"/>
                    <line x1="44" y1="43" x2="38" y2="55" stroke="#000" stroke-width="2"/>
                    <line x1="56" y1="43" x2="62" y2="55" stroke="#000" stroke-width="2"/>
                    <line x1="10" y1="60" x2="90" y2="60" stroke="#8B4513" stroke-width="4"/>
                    <circle cx="20" cy="50" r="2" fill="#FFD700" opacity="0.7"/>
                    <circle cx="30" cy="45" r="2" fill="#FFD700" opacity="0.5"/>
                    <circle cx="40" cy="40" r="2" fill="#FFD700" opacity="0.3"/>
                </svg>`
            },
            {
                id: 6,
                title: "ü§∏ TRAMPOLINE TRAP",
                scenario: "You bounce on a trampoline at the lowest point to reach an exit",
                correctAnswer: "greater",
                explanation: "The trampoline must push up harder than gravity to reverse your downward motion!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <circle cx="50" cy="30" r="8" fill="#FFB6C1"/>
                    <rect x="46" y="38" width="8" height="15" fill="#4169E1"/>
                    <line x1="42" y1="53" x2="46" y2="59" stroke="#000" stroke-width="3"/>
                    <line x1="58" y1="53" x2="54" y2="59" stroke="#000" stroke-width="3"/>
                    <path d="M 20 62 Q 50 70 80 62" fill="none" stroke="#000" stroke-width="4"/>
                    <circle cx="20" cy="62" r="3" fill="#808080"/>
                    <circle cx="80" cy="62" r="3" fill="#808080"/>
                    <line x1="20" y1="62" x2="20" y2="70" stroke="#808080" stroke-width="3"/>
                    <line x1="80" y1="62" x2="80" y2="70" stroke="#808080" stroke-width="3"/>
                </svg>`
            },
            {
                id: 7,
                title: "üìâ DOWNWARD DESCENT",
                scenario: "The elevator accelerates downward toward the basement",
                correctAnswer: "less",
                explanation: "When accelerating downward, the normal force is less than gravity!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <rect x="25" y="15" width="50" height="55" fill="#C0C0C0" stroke="#808080" stroke-width="3"/>
                    <circle cx="50" cy="35" r="8" fill="#FFB6C1"/>
                    <rect x="46" y="43" width="8" height="18" fill="#4169E1"/>
                    <line x1="42" y1="61" x2="46" y2="67" stroke="#000" stroke-width="3"/>
                    <line x1="58" y1="61" x2="54" y2="67" stroke="#000" stroke-width="3"/>
                    <polygon points="40,72 50,80 60,72" fill="#FF0000"/>
                </svg>`
            },
            {
                id: 8,
                title: "ü™¢ HANGING PUZZLE",
                scenario: "A block hangs at rest from a string (consider the string tension)",
                correctAnswer: "equal",
                explanation: "The tension in the string exactly balances the gravitational force!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <line x1="10" y1="8" x2="90" y2="8" stroke="#000" stroke-width="4"/>
                    <line x1="50" y1="8" x2="50" y2="40" stroke="#8B4513" stroke-width="3"/>
                    <rect x="40" y="40" width="20" height="15" fill="#4169E1" stroke="#000080" stroke-width="2"/>
                    <text x="50" y="49" text-anchor="middle" font-size="7" fill="white">BLOCK</text>
                    <circle cx="50" cy="8" r="3" fill="#000"/>
                </svg>`
            },
            {
                id: 9,
                title: "üÜì FREE FALL CHAMBER",
                scenario: "You're on a scale in a falling elevator",
                correctAnswer: "less",
                explanation: "In free fall, the scale can't push up against gravity - it reads nearly zero!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <rect x="25" y="8" width="50" height="55" fill="#C0C0C0" stroke="#808080" stroke-width="3" stroke-dasharray="4,4"/>
                    <circle cx="50" cy="25" r="6" fill="#FFB6C1"/>
                    <rect x="47" y="31" width="6" height="12" fill="#4169E1"/>
                    <line x1="44" y1="43" x2="47" y2="49" stroke="#000" stroke-width="2"/>
                    <line x1="56" y1="43" x2="53" y2="49" stroke="#000" stroke-width="2"/>
                    <rect x="35" y="49" width="30" height="6" fill="#808080" stroke="#000" stroke-width="2"/>
                    <circle cx="50" cy="60" r="8" fill="#E0E0E0" stroke="#000" stroke-width="2"/>
                    <text x="50" y="63" text-anchor="middle" font-size="7" fill="#000">0 N</text>
                    <polygon points="80,40 85,50 90,40" fill="#FF0000"/>
                    <text x="78" y="57" font-size="6" fill="#FF0000">FALL</text>
                </svg>`
            },
            {
                id: 10,
                title: "ü§∏‚Äç‚ôÄÔ∏è GYMNAST'S LANDING",
                scenario: "A gymnast lands on a mat after jumping from a platform",
                correctAnswer: "greater",
                explanation: "The mat must provide a large upward force to stop the gymnast's fall quickly!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <circle cx="50" cy="25" r="8" fill="#FFB6C1"/>
                    <rect x="46" y="33" width="8" height="15" fill="#FF1493"/>
                    <line x1="38" y1="38" x2="32" y2="30" stroke="#FFB6C1" stroke-width="3"/>
                    <line x1="62" y1="38" x2="68" y2="30" stroke="#FFB6C1" stroke-width="3"/>
                    <line x1="42" y1="48" x2="38" y2="58" stroke="#000" stroke-width="3"/>
                    <line x1="58" y1="48" x2="62" y2="58" stroke="#000" stroke-width="3"/>
                    <rect x="20" y="58" width="60" height="10" fill="#4169E1" stroke="#000080" stroke-width="2"/>
                    <polygon points="42,18 50,10 58,18" fill="#FF0000"/>
                </svg>`
            },
            {
                id: 11,
                title: "üöõ TRUCK TRANSPORT",
                scenario: "A box sits on the floor of a truck driving at constant speed",
                correctAnswer: "equal",
                explanation: "With no vertical acceleration, the floor force exactly equals gravity!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <rect x="15" y="45" width="70" height="25" fill="#808080" stroke="#000" stroke-width="3"/>
                    <circle cx="25" cy="70" r="5" fill="#000"/>
                    <circle cx="75" cy="70" r="5" fill="#000"/>
                    <rect x="40" y="32" width="20" height="15" fill="#8B4513" stroke="#654321" stroke-width="2"/>
                </svg>`
            },
            {
                id: 12,
                title: "üöÄ ROCKET LAUNCH",
                scenario: "You're in a rocket ship accelerating upward during launch",
                correctAnswer: "greater",
                explanation: "The rocket seat must push up harder than gravity to accelerate you upward!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <polygon points="42,15 50,8 58,15 58,58 42,58" fill="#C0C0C0" stroke="#808080" stroke-width="3"/>
                    <circle cx="50" cy="28" r="5" fill="#FFB6C1"/>
                    <rect x="47" y="33" width="6" height="12" fill="#4169E1"/>
                    <polygon points="42,58 50,65 58,58" fill="#FF4500"/>
                    <polygon points="38,65 50,72 62,65" fill="#FF6500"/>
                    <polygon points="35,72 50,80 65,72" fill="#FF8500"/>
                </svg>`
            },
            {
                id: 13,
                title: "üíé CHANDELIER CLUE",
                scenario: "An ornate chandelier hangs from the laboratory ceiling",
                correctAnswer: "equal",
                explanation: "The ceiling cable tension exactly balances the chandelier's weight!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <line x1="0" y1="8" x2="100" y2="8" stroke="#8B4513" stroke-width="5"/>
                    <line x1="50" y1="8" x2="50" y2="32" stroke="#000" stroke-width="3"/>
                    <circle cx="50" cy="38" r="10" fill="#FFD700" stroke="#DAA520" stroke-width="3"/>
                    <circle cx="43" cy="45" r="4" fill="#FFFF00"/>
                    <circle cx="57" cy="45" r="4" fill="#FFFF00"/>
                    <circle cx="50" cy="52" r="4" fill="#FFFF00"/>
                    <circle cx="38" cy="52" r="3" fill="#FFFF00"/>
                    <circle cx="62" cy="52" r="3" fill="#FFFF00"/>
                </svg>`
            },
            {
                id: 14,
                title: "ü™Ç BUNGEE BOTTOM",
                scenario: "You're on a bungee cord at the bottom of your fall",
                correctAnswer: "greater",
                explanation: "The stretched bungee cord pulls up with more force than gravity to reverse your motion!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <line x1="50" y1="0" x2="50" y2="8" stroke="#000" stroke-width="4"/>
                    <path d="M 50 8 Q 42 20 50 32 Q 58 44 50 56" fill="none" stroke="#FF1493" stroke-width="4"/>
                    <circle cx="50" cy="62" r="8" fill="#FFB6C1"/>
                    <rect x="46" y="56" width="8" height="6" fill="#4169E1"/>
                    <line x1="42" y1="70" x2="46" y2="77" stroke="#000" stroke-width="3"/>
                    <line x1="58" y1="70" x2="54" y2="77" stroke="#000" stroke-width="3"/>
                </svg>`
            },
            {
                id: 15,
                title: "ü™Ç PARACHUTE DESCENT",
                scenario: "A parachutist falls at constant velocity",
                correctAnswer: "equal",
                explanation: "At constant velocity, air resistance perfectly balances gravity!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <path d="M 25 20 Q 50 8 75 20 Q 62 32 50 26 Q 38 32 25 20" fill="#FF0000" stroke="#8B0000" stroke-width="2"/>
                    <line x1="50" y1="26" x2="50" y2="45" stroke="#000" stroke-width="2"/>
                    <circle cx="50" cy="52" r="5" fill="#FFB6C1"/>
                    <rect x="47" y="57" width="6" height="10" fill="#4169E1"/>
                    <line x1="44" y1="67" x2="47" y2="73" stroke="#000" stroke-width="3"/>
                    <line x1="56" y1="67" x2="53" y2="73" stroke="#000" stroke-width="3"/>
                </svg>`
            },
            {
                id: 16,
                title: "üö™ THE ESCAPE DOOR",
                scenario: "The final puzzle: You stand at the laboratory exit door, ready to escape!",
                correctAnswer: "equal",
                explanation: "Perfect equilibrium - the floor pushes up with exactly the same force as gravity pulls down! The door unlocks and you're FREE!",
                image: `<svg width="100" height="80" viewBox="0 0 100 80">
                    <rect x="15" y="10" width="70" height="60" fill="#8B4513" stroke="#654321" stroke-width="3"/>
                    <rect x="20" y="15" width="60" height="50" fill="#D2691E" stroke="#8B4513" stroke-width="2"/>
                    <circle cx="75" cy="40" r="3" fill="#FFD700"/>
                    <rect x="72" y="38" width="6" height="4" fill="#C0C0C0"/>
                    <circle cx="50" cy="45" r="8" fill="#FFB6C1"/>
                    <rect x="46" y="53" width="8" height="15" fill="#4169E1"/>
                    <line x1="42" y1="68" x2="46" y2="75" stroke="#000" stroke-width="3"/>
                    <line x1="58" y1="68" x2="54" y2="75" stroke="#000" stroke-width="3"/>
                    <line x1="10" y1="75" x2="90" y2="75" stroke="#696969" stroke-width="4"/>
                    <rect x="30" y="25" width="4" height="8" fill="#FFD700"/>
                    <rect x="36" y="25" width="4" height="8" fill="#FFD700"/>
                    <rect x="60" y="25" width="4" height="8" fill="#FFD700"/>
                    <rect x="66" y="25" width="4" height="8" fill="#FFD700"/>
                </svg>`
            }
        ];

        function updateTimer() {
            const elapsed = Date.now() - startTime;
            const minutes = Math.floor(elapsed / 60000);
            const seconds = Math.floor((elapsed % 60000) / 1000);
            const timerElement = document.getElementById('timer');
            timerElement.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        function startTimer() {
            timerInterval = setInterval(updateTimer, 1000);
            updateTimer(); // Update immediately
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
            }
        }

        function initializeProgressOrbs() {
            const orbsContainer = document.getElementById('progress-orbs');
            orbsContainer.innerHTML = '';
            
            for (let i = 0; i < puzzles.length; i++) {
                const orb = document.createElement('div');
                orb.className = 'progress-orb';
                orb.id = `orb-${i}`;
                orbsContainer.appendChild(orb);
            }
        }

        function updateProgressOrbs() {
            for (let i = 0; i < puzzles.length; i++) {
                const orb = document.getElementById(`orb-${i}`);
                if (solvedPuzzles.has(i)) {
                    orb.classList.add('completed');
                }
            }
            
            const progressText = document.getElementById('progress-text');
            progressText.textContent = `${solvedPuzzles.size} / ${puzzles.length} PUZZLES SOLVED`;
        }

        function renderCurrentPuzzle() {
            const container = document.getElementById('current-puzzle');
            
            if (currentPuzzleIndex >= puzzles.length) {
                showEscapeSuccess();
                return;
            }

            const puzzle = puzzles[currentPuzzleIndex];
            const forceType = [8, 13, 14, 15].includes(puzzle.id) ? 'Tension' : 'Normal force';
            const forceSymbol = [8, 13, 14, 15].includes(puzzle.id) ? 'Ft' : 'Fn';
            
            container.innerHTML = `
                <div class="puzzle-card rounded-xl p-4 md:p-6">
                    <div class="text-center mb-4">
                        <h2 class="text-xl md:text-2xl font-bold text-cyan-300 mb-2">${puzzle.title}</h2>
                        <div class="text-sm md:text-base text-yellow-300">üß© PUZZLE ${currentPuzzleIndex + 1} OF ${puzzles.length}</div>
                    </div>
                    
                    <div class="flex flex-col md:flex-row items-center gap-4 mb-6">
                        <div class="flex-shrink-0 bg-black bg-opacity-30 p-3 rounded-lg">
                            ${puzzle.image}
                        </div>
                        <div class="flex-1 text-center md:text-left">
                            <p class="text-base md:text-lg text-white mb-3">${puzzle.scenario}</p>
                            <div class="text-sm md:text-base text-cyan-200">
                                <strong>üîç ANALYZE:</strong> How does the ${forceType.toLowerCase()} compare to gravity?
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid gap-3 max-w-xl mx-auto">
                        <button class="answer-btn p-4 rounded-lg text-left transition-all duration-200" 
                                onclick="selectAnswer('greater', this)">
                            <div class="font-bold text-sm md:text-base text-white">${forceType} is GREATER than gravity</div>
                            <div class="text-cyan-300 mt-1 text-xs md:text-sm">${forceSymbol} > Fg</div>
                        </button>
                        
                        <button class="answer-btn p-4 rounded-lg text-left transition-all duration-200" 
                                onclick="selectAnswer('equal', this)">
                            <div class="font-bold text-sm md:text-base text-white">${forceType} EQUALS gravity</div>
                            <div class="text-cyan-300 mt-1 text-xs md:text-sm">${forceSymbol} = Fg</div>
                        </button>
                        
                        <button class="answer-btn p-4 rounded-lg text-left transition-all duration-200" 
                                onclick="selectAnswer('less', this)">
                            <div class="font-bold text-sm md:text-base text-white">${forceType} is LESS than gravity</div>
                            <div class="text-cyan-300 mt-1 text-xs md:text-sm">${forceSymbol} < Fg</div>
                        </button>
                    </div>
                    
                    <div id="puzzle-feedback" class="hidden mt-4 p-4 rounded-lg text-center">
                        <div id="feedback-text" class="text-base md:text-lg font-bold mb-2"></div>
                        <div id="explanation-text" class="text-sm md:text-base"></div>
                    </div>
                </div>
            `;
        }

        function selectAnswer(selectedAnswer, buttonElement) {
            const puzzle = puzzles[currentPuzzleIndex];
            const isCorrect = selectedAnswer === puzzle.correctAnswer;
            const feedbackDiv = document.getElementById('puzzle-feedback');
            const feedbackText = document.getElementById('feedback-text');
            const explanationText = document.getElementById('explanation-text');

            // Disable all buttons
            const allButtons = buttonElement.parentElement.querySelectorAll('.answer-btn');
            allButtons.forEach(btn => {
                btn.style.pointerEvents = 'none';
                btn.classList.remove('hover:bg-cyan-200', 'hover:border-cyan-500');
            });

            // Style the selected button and show feedback
            if (isCorrect) {
                buttonElement.classList.add('correct-answer');
                feedbackText.textContent = window.elementSdk?.config?.success_message || defaultConfig.success_message;
                feedbackText.className = 'text-xl font-bold mb-3 text-green-400';
                feedbackDiv.className = 'mt-6 p-6 rounded-lg text-center bg-green-900 bg-opacity-30 border border-green-500';
                
                solvedPuzzles.add(currentPuzzleIndex);
                updateProgressOrbs();
                
                setTimeout(() => {
                    currentPuzzleIndex++;
                    renderCurrentPuzzle();
                }, 2000);
                
            } else {
                buttonElement.classList.add('wrong-answer');
                feedbackText.textContent = window.elementSdk?.config?.failure_message || defaultConfig.failure_message;
                feedbackText.className = 'text-xl font-bold mb-3 text-red-400';
                feedbackDiv.className = 'mt-6 p-6 rounded-lg text-center bg-red-900 bg-opacity-30 border border-red-500';
                
                // Add restart message
                const restartMessage = document.createElement('div');
                restartMessage.className = 'text-lg text-red-300 mt-3';
                restartMessage.textContent = 'üîÑ SECURITY BREACH! Restarting escape room in 3 seconds...';
                feedbackDiv.appendChild(restartMessage);
                
                setTimeout(() => {
                    restartEscapeRoom();
                }, 3000);
            }

            explanationText.textContent = puzzle.explanation;
            explanationText.className = 'text-lg text-cyan-100';
            feedbackDiv.classList.remove('hidden');
        }

        function showEscapeSuccess() {
            stopTimer();
            const finalTime = document.getElementById('timer').textContent;
            document.getElementById('current-puzzle').style.display = 'none';
            document.querySelector('.mb-8').style.display = 'none'; // Hide progress tracker
            
            // Update success message with final time
            const successDiv = document.getElementById('escape-success');
            const timeMessage = document.createElement('p');
            timeMessage.className = 'text-2xl text-cyan-300 mb-4 font-mono';
            timeMessage.innerHTML = `‚è±Ô∏è ESCAPE TIME: ${finalTime}`;
            
            // Insert time message after the congratulations text
            const congratsText = successDiv.querySelector('p');
            congratsText.parentNode.insertBefore(timeMessage, congratsText.nextSibling);
            
            successDiv.classList.remove('hidden');
        }

        function restartEscapeRoom() {
            currentPuzzleIndex = 0;
            solvedPuzzles.clear();
            
            // Reset timer
            stopTimer();
            startTime = Date.now();
            startTimer();
            
            // Remove any existing time message from success screen
            const successDiv = document.getElementById('escape-success');
            const existingTimeMessage = successDiv.querySelector('.font-mono');
            if (existingTimeMessage) {
                existingTimeMessage.remove();
            }
            
            document.getElementById('escape-success').classList.add('hidden');
            document.getElementById('current-puzzle').style.display = 'block';
            document.querySelector('.mb-8').style.display = 'block';
            
            initializeProgressOrbs();
            updateProgressOrbs();
            renderCurrentPuzzle();
        }

        async function onConfigChange(config) {
            const titleElement = document.getElementById('room-title');
            const storyElement = document.getElementById('story-intro');
            
            if (titleElement) {
                titleElement.textContent = config.room_title || defaultConfig.room_title;
            }
            if (storyElement) {
                storyElement.textContent = config.story_intro || defaultConfig.story_intro;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            startTimer();
            initializeProgressOrbs();
            updateProgressOrbs();
            renderCurrentPuzzle();
            
            document.getElementById('restart-btn').addEventListener('click', restartEscapeRoom);
            
            if (window.elementSdk) {
                window.elementSdk.init({
                    defaultConfig: defaultConfig,
                    onConfigChange: onConfigChange,
                    mapToCapabilities: (config) => ({
                        recolorables: [],
                        borderables: [],
                        fontEditable: undefined,
                        fontSizeable: undefined
                    }),
                    mapToEditPanelValues: (config) => new Map([
                        ["room_title", config.room_title || defaultConfig.room_title],
                        ["story_intro", config.story_intro || defaultConfig.story_intro],
                        ["success_message", config.success_message || defaultConfig.success_message],
                        ["failure_message", config.failure_message || defaultConfig.failure_message]
                    ])
                });
            }
        });
    </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'995dc19e249b445f',t:'MTc2MTY4OTM1NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
